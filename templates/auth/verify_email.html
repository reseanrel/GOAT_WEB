{% extends "base.html" %}

{% block content %}
<div class="register-container">
    <div class="auth-card" style="max-width: 500px;">
        <div class="auth-header">
            <h2><i class="fas fa-envelope me-2"></i>Verify Your Email</h2>
            <p class="mb-0">We've sent a verification code to {{ email }}</p>
        </div>
        <div class="auth-body">
            <form method="POST" action="{{ url_for('verify_email') }}">
                <div class="mb-3">
                    <label class="form-label">Verification Code *</label>
                    <input type="text" class="form-control" name="verification_code" placeholder="Enter 6-digit code" required maxlength="6">
                </div>

                <button type="submit" class="btn btn-primary w-100 mb-3">
                    <i class="fas fa-check me-2"></i>Verify Email
                </button>
            </form>

            <div class="text-center mb-3">
                <p class="mb-2">Didn't receive the code?</p>
                <button id="resend-btn" class="btn btn-outline-secondary" onclick="resendCode()">
                    <i class="fas fa-redo me-2"></i>Resend Code
                </button>
            </div>

            <div class="text-center">
                <a href="{{ url_for('register') }}" class="text-decoration-none">Back to Registration</a>
            </div>
        </div>
    </div>
</div>

<script>
function resendCode() {
    const btn = document.getElementById('resend-btn');
    btn.disabled = true;
    btn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Resending...';

    fetch('{{ url_for("resend_verification") }}', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        }
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            alert('Verification code resent successfully!');
        } else {
            alert('Failed to resend code. Please try again.');
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert('An error occurred. Please try again.');
    })
    .finally(() => {
        btn.disabled = false;
        btn.innerHTML = '<i class="fas fa-redo me-2"></i>Resend Code';
    });
}
</script>
{% endblock %}
